/*! game-off-2013 - v0.1.0 - 2013-11-07 */
!function(a,b,c){function d(c,f){if(!b[c]){if(!a[c]){var g="function"==typeof require&&require;if(!f&&g)return g(c,!0);if(e)return e(c,!0);throw new Error("Cannot find module '"+c+"'")}var h=b[c]={exports:{}};a[c][0].call(h.exports,function(b){var e=a[c][1][b];return d(e?e:b)},h,h.exports)}return b[c].exports}for(var e="function"==typeof require&&require,f=0;f<c.length;f++)d(c[f]);return d}({1:[function(a){a("./core/class.js"),a("./core/requestAnimFrame");var b=a("./data/media"),c=a("./engine/assets"),d=a("./game.js");window.addEventListener("load",function(){c.loadAll(b),window.b=c,new d})},{"./core/class.js":2,"./game.js":3,"./core/requestAnimFrame":4,"./engine/assets":5,"./data/media":6}],2:[function(){!function(){var a=!1,b=/xyz/.test(function(){})?/\bparent\b/:/.*/;this.Class=function(){},Class.extend=function(c){function d(){!a&&this.init&&this.init.apply(this,arguments)}var e=this.prototype;a=!0;var f=new this;a=!1;for(var g in c)f[g]="function"==typeof c[g]&&"function"==typeof e[g]&&b.test(c[g])?function(a,b){return function(){var c=this.parent;this.parent=e[a];var d=b.apply(this,arguments);return this.parent=c,d}}(g,c[g]):c[g];return d.prototype=f,d.prototype.constructor=d,d.extend=arguments.callee,d}}()},{}],4:[function(){window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}()},{}],6:[function(a,b){var c={img:{abc:{file:"test"},def:{file:"test2",scale:[1,2,3,4,5,6,7,8,9,10]},test:{file:"test"},items:{},tilesets:{},fonts:{},other:{}},sfx:{sounds:{},music:{}},data:{}};b.exports=c},{}],3:[function(a,b){var c=a("./engine/engine"),d=(a("./engine/assets"),c.extend({init:function(){this.parent(),this.tick()},update:function(){this.parent()}}));b.exports=d},{"./engine/engine":7,"./engine/assets":5}],5:[function(a,b){var c=a("../config"),d=a("./graphic");Object.$get=function(a,b){if(!b)return a;for(var c=b.split(".");c.length;){var d=c.shift();if(!(d in a))return;a=a[d]}return a},Object.$set=function(a,b,c){if(b)for(var d=b.split(".");d.length;){var e=d.shift();d.length>0?(a[e]={},a=a[e]):a[e]=c}},Assets={Graphics:{},Sounds:{},Data:{},_stack:{unloaded:0,items:{},total:0},get ready(){return this._stack.unloaded<=0},get completion(){return 100-~~(this._stack.unloaded/this._stack.total*100)},_doneLoading:function(a){this._stack.unloaded--,this._stack.unloaded<=0&&(this._stack.unloaded=0,this._stack.items={},this._stack.total=0),console.log(a+" loaded "+(new Date).getTime()+" - Completion: %c"+this.completion+" %","color: green; font-size: 14px;")},_loadImage:function(a,b){-1==b.file.indexOf(".")&&(b.file+="."+c.defaultExt.img);var e=a.replace("img.","");a=a.split("."),a.pop(),a=a.join("/"),a=c.assetsPath+a+"/"+b.file;var f=new d(a,b,this._doneLoading.bind(this));Object.$set(Assets.Graphics,e,f)},_loadSound:function(){},_loadData:function(){},_load:function(a,b){if(b&&a){var c=Assets,d=Object.$get(a,b),e=b.split(".")[0];switch(e){case"sfx":c._loadSound(b,d);break;case"img":c._loadImage(b,d);break;case"data":c._loadData(b,d)}}},loadAll:function(a,b){var c=Assets,d=Object.$get(a,b);for(var e in d){var f=b?b+"."+e:e;d[e].file?(this._stack.items[f]=d[e],this._stack.unloaded++,this._stack.total++):"object"==typeof d[e]&&c.loadAll(a,f)}if(!b)for(var g in this._stack.items)this._load(a,g)}},b.exports=Assets},{"../config":8,"./graphic":9}],9:[function(a,b){var c=Class.extend({loaded:!1,path:"",width:0,height:0,image:null,scaled:{},scale:[],_onloadCallback:null,init:function(a,b,c){this.path=a,this.scale=b?b.scale:null,this._onloadCallback=c,this._load()},_load:function(){this.loaded||(this.image=new Image,this.image.onload=this._onload.bind(this),this.image.onerror=this._onerror.bind(this),this.image.src=this.path)},_onload:function(){if(this.loaded=!0,this.width=this.image.width,this.height=this.image.height,this.scale)if(1==this.scale.length)1!=this.scale[0]&&(this.image=this.resize(this.image,this.scale[0]));else{for(var a=0;a<this.scale.length;a++){var b=this.scale[a];this.scaled[b]=this.resize(this.image,b)}this.image=this.scaled[this.scale[0]]}this._onloadCallback(this.path)},_onerror:function(){throw"An error happened while loading "+this.path},resize:function(a,b){var c=document.createElement("canvas");c.width=a.width,c.height=a.height;var d=c.getContext("2d");d.drawImage(a,0,0);var e=d.getImageData(0,0,a.width,a.height).data,f=a.width*b,g=a.height*b,h=document.createElement("canvas");h.width=f,h.height=g;for(var i=h.getContext("2d"),j=i.getImageData(0,0,f,g),k=j.data,l=0,m=0,n=0;n<this.height;++n)for(var o=0;b>o;++o)for(var p=0;p<this.width;++p){l=4*(n*this.width+p);for(var q=0;b>q;++q){var r=l;k[m++]=e[r++],k[m++]=e[r++],k[m++]=e[r++],k[m++]=e[r++]}}return i.putImageData(j,0,0),h}});b.exports=c},{}],8:[function(a,b){var c={assetsPath:"media/",defaultExt:{img:"png"},base:{width:480,height:320,scale:20,clearColor:"#000000"},height:{abc:123}};b.exports=c},{}],7:[function(a,b){var c=a("../config"),d=Class.extend({init:function(){this.paused=!1,this.screens=[],this.draws=0,this.canvas=null,this.context=null,this.initCanvas()}});d.prototype.initCanvas=function(){var a=document.getElementById("canvas");if(!a){a.width=c.base.width,a.height=c.base.height;var b=document.getElementById(c.base.container)||document.body;b.appendChild(a)}a.style.imageRendering="-moz-crisp-edges",a.style.imageRendering="-o-crisp-edges",a.style.imageRendering="-webkit-optimize-contrast",a.style.imageRendering="crisp-edges",a.style.msInterpolationMode="nearest-neighbor",this.canvas=a,this.context=a.getContext("2d"),this.context.imageSmoothingEnabled=!1,this.context.webkitImageSmoothingEnabled=!1,this.context.mozImageSmoothingEnabled=!1},d.prototype.update=function(){},d.prototype.draw=function(){this.draws=0;for(var a=this.screens.length;a;a--)this.screens[a].clear(c.base.clearColor)},d.prototype.togglePause=function(){this.paused=!this.paused,this.paused||this.tick()},d.prototype.tick=function(){this.paused||(this.update(),requestAnimFrame(this.tick.bind(this)),this.draw())},b.exports=d},{"../config":8}]},{},[1]);